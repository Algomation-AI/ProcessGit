<?xml version="1.0" encoding="UTF-8"?>
<cmmn:definitions xmlns:cmmn="http://www.omg.org/spec/CMMN/20151109/MODEL"
                  xmlns:cmmndi="http://www.omg.org/spec/CMMN/20151109/CMMNDI"
                  xmlns:dc="http://www.omg.org/spec/CMMN/20151109/DC"
                  xmlns:di="http://www.omg.org/spec/CMMN/20151109/DI"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  id="DocumentReviewException"
                  targetNamespace="http://processgit.io/cmmn/document-review-exception">
  
  <cmmn:case id="Case_DocumentReviewException" name="Document Review Exception Case">
    
    <cmmn:casePlanModel id="CasePlanModel_1" name="Document Review Exception Management">
      
      <!-- Case File -->
      <cmmn:caseFileModel id="CaseFileModel_1">
        <cmmn:caseFileItem id="CaseFile_DocumentDetails" name="Document Details" definitionRef="DocumentDetails"/>
        <cmmn:caseFileItem id="CaseFile_ExceptionInfo" name="Exception Information" definitionRef="ExceptionInfo"/>
        <cmmn:caseFileItem id="CaseFile_Resolution" name="Resolution" definitionRef="Resolution"/>
      </cmmn:caseFileModel>
      
      <!-- Plan Items -->
      
      <!-- Stage: Exception Assessment -->
      <cmmn:planItem id="PI_ExceptionAssessment" definitionRef="Stage_ExceptionAssessment">
        <cmmn:entryCriterion id="EntryCriterion_1" sentryRef="Sentry_CaseStart"/>
      </cmmn:planItem>
      
      <!-- Stage: Resolution Actions -->
      <cmmn:planItem id="PI_ResolutionActions" definitionRef="Stage_ResolutionActions">
        <cmmn:entryCriterion id="EntryCriterion_2" sentryRef="Sentry_AssessmentComplete"/>
      </cmmn:planItem>
      
      <!-- Stage: Escalation (Optional) -->
      <cmmn:planItem id="PI_Escalation" definitionRef="Stage_Escalation">
        <cmmn:entryCriterion id="EntryCriterion_3" sentryRef="Sentry_EscalationNeeded"/>
      </cmmn:planItem>
      
      <!-- Milestone: Exception Resolved -->
      <cmmn:planItem id="PI_ExceptionResolved" definitionRef="Milestone_ExceptionResolved">
        <cmmn:entryCriterion id="EntryCriterion_4" sentryRef="Sentry_ResolutionComplete"/>
      </cmmn:planItem>
      
      <!-- Sentries -->
      <cmmn:sentry id="Sentry_CaseStart">
        <cmmn:planItemOnPart id="PlanItemOnPart_1" sourceRef="PI_ExceptionAssessment">
          <cmmn:standardEvent>create</cmmn:standardEvent>
        </cmmn:planItemOnPart>
      </cmmn:sentry>
      
      <cmmn:sentry id="Sentry_AssessmentComplete">
        <cmmn:planItemOnPart id="PlanItemOnPart_2" sourceRef="PI_ExceptionAssessment">
          <cmmn:standardEvent>complete</cmmn:standardEvent>
        </cmmn:planItemOnPart>
      </cmmn:sentry>
      
      <cmmn:sentry id="Sentry_EscalationNeeded">
        <cmmn:ifPart id="IfPart_1">
          <cmmn:condition xsi:type="cmmn:tExpression">
            <cmmn:body>exceptionType == "critical" || exceptionAge &gt; 72</cmmn:body>
          </cmmn:condition>
        </cmmn:ifPart>
      </cmmn:sentry>
      
      <cmmn:sentry id="Sentry_ResolutionComplete">
        <cmmn:planItemOnPart id="PlanItemOnPart_3" sourceRef="PI_ResolutionActions">
          <cmmn:standardEvent>complete</cmmn:standardEvent>
        </cmmn:planItemOnPart>
      </cmmn:sentry>
      
      <!-- Stage Definitions -->
      
      <!-- Exception Assessment Stage -->
      <cmmn:stage id="Stage_ExceptionAssessment" name="Exception Assessment">
        
        <cmmn:planItem id="PI_CaptureException" definitionRef="Task_CaptureException"/>
        
        <cmmn:planItem id="PI_ClassifyException" definitionRef="Task_ClassifyException">
          <cmmn:entryCriterion id="EntryCriterion_5" sentryRef="Sentry_ExceptionCaptured"/>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_DetermineImpact" definitionRef="Task_DetermineImpact">
          <cmmn:entryCriterion id="EntryCriterion_6" sentryRef="Sentry_ExceptionClassified"/>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_AssignOwner" definitionRef="Task_AssignOwner">
          <cmmn:entryCriterion id="EntryCriterion_7" sentryRef="Sentry_ImpactDetermined"/>
        </cmmn:planItem>
        
        <cmmn:sentry id="Sentry_ExceptionCaptured">
          <cmmn:planItemOnPart id="PlanItemOnPart_4" sourceRef="PI_CaptureException">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
        <cmmn:sentry id="Sentry_ExceptionClassified">
          <cmmn:planItemOnPart id="PlanItemOnPart_5" sourceRef="PI_ClassifyException">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
        <cmmn:sentry id="Sentry_ImpactDetermined">
          <cmmn:planItemOnPart id="PlanItemOnPart_6" sourceRef="PI_DetermineImpact">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
      </cmmn:stage>
      
      <!-- Resolution Actions Stage -->
      <cmmn:stage id="Stage_ResolutionActions" name="Resolution Actions">
        
        <cmmn:planItem id="PI_InvestigateIssue" definitionRef="Task_InvestigateIssue"/>
        
        <cmmn:planItem id="PI_CorrectDocumentFormat" definitionRef="Task_CorrectDocumentFormat">
          <cmmn:itemControl id="ItemControl_1">
            <cmmn:manualActivationRule id="ManualActivationRule_1"/>
          </cmmn:itemControl>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_ObtainMissingInfo" definitionRef="Task_ObtainMissingInfo">
          <cmmn:itemControl id="ItemControl_2">
            <cmmn:manualActivationRule id="ManualActivationRule_2"/>
          </cmmn:itemControl>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_RequestClarification" definitionRef="Task_RequestClarification">
          <cmmn:itemControl id="ItemControl_3">
            <cmmn:manualActivationRule id="ManualActivationRule_3"/>
          </cmmn:itemControl>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_ReassignReviewer" definitionRef="Task_ReassignReviewer">
          <cmmn:itemControl id="ItemControl_4">
            <cmmn:manualActivationRule id="ManualActivationRule_4"/>
          </cmmn:itemControl>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_ImplementSolution" definitionRef="Task_ImplementSolution">
          <cmmn:entryCriterion id="EntryCriterion_8" sentryRef="Sentry_InvestigationComplete"/>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_VerifyResolution" definitionRef="Task_VerifyResolution">
          <cmmn:entryCriterion id="EntryCriterion_9" sentryRef="Sentry_SolutionImplemented"/>
        </cmmn:planItem>
        
        <cmmn:sentry id="Sentry_InvestigationComplete">
          <cmmn:planItemOnPart id="PlanItemOnPart_7" sourceRef="PI_InvestigateIssue">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
        <cmmn:sentry id="Sentry_SolutionImplemented">
          <cmmn:planItemOnPart id="PlanItemOnPart_8" sourceRef="PI_ImplementSolution">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
      </cmmn:stage>
      
      <!-- Escalation Stage -->
      <cmmn:stage id="Stage_Escalation" name="Escalation">
        
        <cmmn:planItem id="PI_NotifyStakeholders" definitionRef="Task_NotifyStakeholders"/>
        
        <cmmn:planItem id="PI_ConveneReviewBoard" definitionRef="Task_ConveneReviewBoard">
          <cmmn:entryCriterion id="EntryCriterion_10" sentryRef="Sentry_StakeholdersNotified"/>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_DevelopActionPlan" definitionRef="Task_DevelopActionPlan">
          <cmmn:entryCriterion id="EntryCriterion_11" sentryRef="Sentry_BoardConvened"/>
        </cmmn:planItem>
        
        <cmmn:planItem id="PI_ApproveException" definitionRef="Task_ApproveException">
          <cmmn:entryCriterion id="EntryCriterion_12" sentryRef="Sentry_ActionPlanDeveloped"/>
        </cmmn:planItem>
        
        <cmmn:sentry id="Sentry_StakeholdersNotified">
          <cmmn:planItemOnPart id="PlanItemOnPart_9" sourceRef="PI_NotifyStakeholders">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
        <cmmn:sentry id="Sentry_BoardConvened">
          <cmmn:planItemOnPart id="PlanItemOnPart_10" sourceRef="PI_ConveneReviewBoard">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
        <cmmn:sentry id="Sentry_ActionPlanDeveloped">
          <cmmn:planItemOnPart id="PlanItemOnPart_11" sourceRef="PI_DevelopActionPlan">
            <cmmn:standardEvent>complete</cmmn:standardEvent>
          </cmmn:planItemOnPart>
        </cmmn:sentry>
        
      </cmmn:stage>
      
      <!-- Task Definitions -->
      
      <!-- Exception Assessment Tasks -->
      <cmmn:humanTask id="Task_CaptureException" name="Capture Exception Details"/>
      <cmmn:humanTask id="Task_ClassifyException" name="Classify Exception Type"/>
      <cmmn:humanTask id="Task_DetermineImpact" name="Determine Business Impact"/>
      <cmmn:humanTask id="Task_AssignOwner" name="Assign Owner"/>
      
      <!-- Resolution Actions Tasks -->
      <cmmn:humanTask id="Task_InvestigateIssue" name="Investigate Root Cause"/>
      <cmmn:humanTask id="Task_CorrectDocumentFormat" name="Correct Document Format"/>
      <cmmn:humanTask id="Task_ObtainMissingInfo" name="Obtain Missing Information"/>
      <cmmn:humanTask id="Task_RequestClarification" name="Request Clarification"/>
      <cmmn:humanTask id="Task_ReassignReviewer" name="Reassign to Different Reviewer"/>
      <cmmn:humanTask id="Task_ImplementSolution" name="Implement Solution"/>
      <cmmn:humanTask id="Task_VerifyResolution" name="Verify Resolution"/>
      
      <!-- Escalation Tasks -->
      <cmmn:humanTask id="Task_NotifyStakeholders" name="Notify Stakeholders"/>
      <cmmn:humanTask id="Task_ConveneReviewBoard" name="Convene Review Board"/>
      <cmmn:humanTask id="Task_DevelopActionPlan" name="Develop Action Plan"/>
      <cmmn:humanTask id="Task_ApproveException" name="Approve Exception"/>
      
      <!-- Milestone Definition -->
      <cmmn:milestone id="Milestone_ExceptionResolved" name="Exception Resolved"/>
      
    </cmmn:casePlanModel>
    
  </cmmn:case>
  
  <!-- Case File Item Definitions -->
  <cmmn:caseFileItemDefinition id="DocumentDetails" name="Document Details"/>
  <cmmn:caseFileItemDefinition id="ExceptionInfo" name="Exception Information"/>
  <cmmn:caseFileItemDefinition id="Resolution" name="Resolution"/>
  
  <!-- Diagram -->
  <cmmndi:CMMNDI>
    <cmmndi:CMMNDiagram id="CMMNDiagram_1">
      <cmmndi:Size width="1200" height="800"/>
      
      <cmmndi:CMMNShape id="CMMNShape_CasePlan" cmmnElementRef="CasePlanModel_1">
        <dc:Bounds x="50" y="50" width="1100" height="700"/>
      </cmmndi:CMMNShape>
      
      <!-- Exception Assessment Stage -->
      <cmmndi:CMMNShape id="CMMNShape_ExceptionAssessment" cmmnElementRef="PI_ExceptionAssessment">
        <dc:Bounds x="100" y="100" width="300" height="250"/>
      </cmmndi:CMMNShape>
      
      <!-- Resolution Actions Stage -->
      <cmmndi:CMMNShape id="CMMNShape_ResolutionActions" cmmnElementRef="PI_ResolutionActions">
        <dc:Bounds x="450" y="100" width="350" height="350"/>
      </cmmndi:CMMNShape>
      
      <!-- Escalation Stage -->
      <cmmndi:CMMNShape id="CMMNShape_Escalation" cmmnElementRef="PI_Escalation">
        <dc:Bounds x="850" y="100" width="250" height="250"/>
      </cmmndi:CMMNShape>
      
      <!-- Exception Resolved Milestone -->
      <cmmndi:CMMNShape id="CMMNShape_ExceptionResolved" cmmnElementRef="PI_ExceptionResolved">
        <dc:Bounds x="950" y="500" width="100" height="80"/>
      </cmmndi:CMMNShape>
      
      <cmmndi:CMMNShape id="EntryCriterion_1_di" cmmnElementRef="EntryCriterion_1">
        <dc:Bounds x="270" y="126" width="20" height="28" />
      </cmmndi:CMMNShape>
      <cmmndi:CMMNShape id="EntryCriterion_2_di" cmmnElementRef="EntryCriterion_2">
        <dc:Bounds x="420" y="126" width="20" height="28" />
      </cmmndi:CMMNShape>
      <cmmndi:CMMNShape id="EntryCriterion_3_di" cmmnElementRef="EntryCriterion_3">
        <dc:Bounds x="440" y="306" width="20" height="28" />
      </cmmndi:CMMNShape>
    </cmmndi:CMMNDiagram>
  </cmmndi:CMMNDI>
  
</cmmn:definitions>
